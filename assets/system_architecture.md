# AI辅助运输报价系统 - 系统架构图

## 1. 系统整体架构

```
+----------------------------------+
|          客户端应用层             |
|  +----------+    +------------+  |
|  | Web界面  |    | 移动应用    |  |
|  +----------+    +------------+  |
+----------------------------------+
              |
              | HTTPS
              v
+----------------------------------+
|          API网关层               |
|  +----------+    +------------+  |
|  | 认证授权  |    | 请求路由    |  |
|  +----------+    +------------+  |
+----------------------------------+
              |
              | 内部API调用
              v
+----------------------------------+
|          应用服务层              |
|  +----------+    +------------+  |
|  | 用户服务  |    | 报价服务    |  |
|  +----------+    +------------+  |
|  +----------+    +------------+  |
|  | 规则服务  |    | 分析服务    |  |
|  +----------+    +------------+  |
+----------------------------------+
              |
              | 服务间通信
              v
+----------------------------------+
|          核心服务层              |
|  +----------+    +------------+  |
|  | 规则引擎  |    | LLM集成     |  |
|  +----------+    +------------+  |
|  +----------+    +------------+  |
|  | 数据分析  |    | 报告生成    |  |
|  +----------+    +------------+  |
+----------------------------------+
              |
              | 数据访问
              v
+----------------------------------+
|          数据存储层              |
|  +----------+    +------------+  |
|  | 关系数据库|    | 文档存储    |  |
|  +----------+    +------------+  |
|  +----------+                    |
|  | 缓存      |                   |
|  +----------+                    |
+----------------------------------+
```

## 2. 组件详细说明

### 2.1 客户端应用层

- **Web界面**：基于React/Vue的单页面应用，提供完整的用户界面
- **移动应用**：基于React Native的移动应用，支持iOS和Android平台

### 2.2 API网关层

- **认证授权**：处理用户认证、JWT令牌验证和权限控制
- **请求路由**：将请求路由到相应的微服务，处理负载均衡和服务发现

### 2.3 应用服务层

- **用户服务**：处理用户管理、角色和权限控制
- **报价服务**：处理运输报价的创建、查询和管理
- **规则服务**：管理定价规则和业务逻辑规则
- **分析服务**：提供数据分析和报告功能

### 2.4 核心服务层

- **规则引擎**：执行定价规则和业务逻辑规则
- **LLM集成**：与大型语言模型API集成，处理自然语言处理任务
- **数据分析**：执行数据分析算法，提取洞察和模式
- **报告生成**：生成各类报告和可视化内容

### 2.5 数据存储层

- **关系数据库**：存储结构化数据，如用户、报价、规则等
- **文档存储**：存储非结构化数据，如LLM请求和响应
- **缓存**：提高频繁访问数据的性能

## 3. 数据流

### 3.1 报价生成流程

```
用户 -> Web界面 -> API网关 -> 报价服务 -> 规则引擎 -> 数据库
                                |
                                v
                             LLM集成 -> 外部LLM API
                                |
                                v
                             报价服务 -> 用户
```

### 3.2 规则管理流程

```
管理员 -> Web界面 -> API网关 -> 规则服务 -> 规则引擎 -> 数据库
                                  |
                                  v
                               LLM集成 -> 外部LLM API (规则提取)
```

### 3.3 数据分析流程

```
用户 -> Web界面 -> API网关 -> 分析服务 -> 数据分析 -> 数据库
                                |
                                v
                             报告生成 -> 用户
```

## 4. 技术栈

### 4.1 前端技术

- React/Vue.js (Web界面)
- React Native (移动应用)
- TypeScript
- Material UI/Ant Design

### 4.2 后端技术

- Node.js/Python
- Express/FastAPI
- JWT认证
- OpenAPI规范

### 4.3 数据库技术

- PostgreSQL (关系数据库)
- MongoDB (文档存储)
- Redis (缓存)

### 4.4 DevOps技术

- Docker
- Kubernetes
- CI/CD (GitHub Actions)
- 监控 (Prometheus/Grafana)

### 4.5 AI/ML技术

- OpenAI API / Azure OpenAI
- Langchain
- 向量数据库 (可选)

## 5. 安全架构

- HTTPS加密
- JWT令牌认证
- 角色基础访问控制 (RBAC)
- API请求限流
- 数据加密存储
- 安全日志审计 